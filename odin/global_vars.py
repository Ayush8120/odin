from copy import copy

SCANNET_COLOR_MAP_20 = {
    0: (0., 0., 0.),
    1: (174., 199., 232.),
    2: (152., 223., 138.),
    3: (31., 119., 180.),
    4: (255., 187., 120.),
    5: (188., 189., 34.),
    6: (140., 86., 75.),
    7: (255., 152., 150.),
    8: (214., 39., 40.),
    9: (197., 176., 213.),
    10: (148., 103., 189.),
    11: (196., 156., 148.),
    12: (23., 190., 207.),
    13: (247., 182., 210.),
    14: (66., 188., 102.),
    15: (219., 219., 141.),
    16: (140., 57., 197.),
    17: (202., 185., 52.),
    18: (51., 176., 203.),
    19: (200., 54., 131.),
    20: (92., 193., 61.),
    21: (78., 71., 183.),
    22: (172., 114., 82.),
    23: (255., 127., 14.),
    24: (91., 163., 138.),
    25: (91., 163., 138.),
    26: (153., 98., 156.),
    27: (140., 153., 101.),
    28: (158., 218., 229.),
    29: (100., 125., 154.),
    30: (178., 127., 135.),
    31: (178., 127., 135.),
    32: (146., 111., 194.),
    33: (44., 160., 44.),
    34: (112., 128., 144.),
    35: (96., 207., 209.),
    36: (227., 119., 194.),
    37: (213., 92., 176.),
    38: (94., 106., 211.),
    39: (82., 84., 163.),
    40: (100., 85., 144.),
}


SCANNET_COLOR_MAP_200 = {
0: (0., 0., 0.),
1: (174., 199., 232.),
2: (188., 189., 34.),
3: (152., 223., 138.),
4: (255., 152., 150.),
5: (214., 39., 40.),
6: (91., 135., 229.),
7: (31., 119., 180.),
8: (229., 91., 104.),
9: (247., 182., 210.),
10: (91., 229., 110.),
11: (255., 187., 120.),
13: (141., 91., 229.),
14: (112., 128., 144.),
15: (196., 156., 148.),
16: (197., 176., 213.),
17: (44., 160., 44.),
18: (148., 103., 189.),
19: (229., 91., 223.),
21: (219., 219., 141.),
22: (192., 229., 91.),
23: (88., 218., 137.),
24: (58., 98., 137.),
26: (177., 82., 239.),
27: (255., 127., 14.),
28: (237., 204., 37.),
29: (41., 206., 32.),
31: (62., 143., 148.),
32: (34., 14., 130.),
33: (143., 45., 115.),
34: (137., 63., 14.),
35: (23., 190., 207.),
36: (16., 212., 139.),
38: (90., 119., 201.),
39: (125., 30., 141.),
40: (150., 53., 56.),
41: (186., 197., 62.),
42: (227., 119., 194.),
44: (38., 100., 128.),
45: (120., 31., 243.),
46: (154., 59., 103.),
47: (169., 137., 78.),
48: (143., 245., 111.),
49: (37., 230., 205.),
50: (14., 16., 155.),
51: (196., 51., 182.),
52: (237., 80., 38.),
54: (138., 175., 62.),
55: (158., 218., 229.),
56: (38., 96., 167.),
57: (190., 77., 246.),
58: (208., 49., 84.),
59: (208., 193., 72.),
62: (55., 220., 57.),
63: (10., 125., 140.),
64: (76., 38., 202.),
65: (191., 28., 135.),
66: (211., 120., 42.),
67: (118., 174., 76.),
68: (17., 242., 171.),
69: (20., 65., 247.),
70: (208., 61., 222.),
71: (162., 62., 60.),
72: (210., 235., 62.),
73: (45., 152., 72.),
74: (35., 107., 149.),
75: (160., 89., 237.),
76: (227., 56., 125.),
77: (169., 143., 81.),
78: (42., 143., 20.),
79: (25., 160., 151.),
80: (82., 75., 227.),
82: (253., 59., 222.),
84: (240., 130., 89.),
86: (123., 172., 47.),
87: (71., 194., 133.),
88: (24., 94., 205.),
89: (134., 16., 179.),
90: (159., 32., 52.),
93: (213., 208., 88.),
95: (64., 158., 70.),
96: (18., 163., 194.),
97: (65., 29., 153.),
98: (177., 10., 109.),
99: (152., 83., 7.),
100: (83., 175., 30.),
101: (18., 199., 153.),
102: (61., 81., 208.),
103: (213., 85., 216.),
104: (170., 53., 42.),
105: (161., 192., 38.),
106: (23., 241., 91.),
107: (12., 103., 170.),
110: (151., 41., 245.),
112: (133., 51., 80.),
115: (184., 162., 91.),
116: (50., 138., 38.),
118: (31., 237., 236.),
120: (39., 19., 208.),
121: (223., 27., 180.),
122: (254., 141., 85.),
125: (97., 144., 39.),
128: (106., 231., 176.),
130: (12., 61., 162.),
131: (124., 66., 140.),
132: (137., 66., 73.),
134: (250., 253., 26.),
136: (55., 191., 73.),
138: (60., 126., 146.),
139: (153., 108., 234.),
140: (184., 58., 125.),
141: (135., 84., 14.),
145: (139., 248., 91.),
148: (53., 200., 172.),
154: (63., 69., 134.),
155: (190., 75., 186.),
156: (127., 63., 52.),
157: (141., 182., 25.),
159: (56., 144., 89.),
161: (64., 160., 250.),
163: (182., 86., 245.),
165: (139., 18., 53.),
166: (134., 120., 54.),
168: (49., 165., 42.),
169: (51., 128., 133.),
170: (44., 21., 163.),
177: (232., 93., 193.),
180: (176., 102., 54.),
185: (116., 217., 17.),
188: (54., 209., 150.),
191: (60., 99., 204.),
193: (129., 43., 144.),
195: (252., 100., 106.),
202: (187., 196., 73.),
208: (13., 158., 40.),
213: (52., 122., 152.),
214: (128., 76., 202.),
221: (187., 50., 115.),
229: (180., 141., 71.),
230: (77., 208., 35.),
232: (72., 183., 168.),
233: (97., 99., 203.),
242: (172., 22., 158.),
250: (155., 64., 40.),
261: (118., 159., 30.),
264: (69., 252., 148.),
276: (45., 103., 173.),
283: (111., 38., 149.),
286: (184., 9., 49.),
300: (188., 174., 67.),
304: (53., 206., 53.),
312: (97., 235., 252.),
323: (66., 32., 182.),
325: (236., 114., 195.),
331: (241., 154., 83.),
342: (133., 240., 52.),
356: (16., 205., 144.),
370: (75., 101., 198.),
392: (237., 95., 251.),
395: (191., 52., 49.),
399: (227., 254., 54.),
408: (49., 206., 87.),
417: (48., 113., 150.),
488: (125., 73., 182.),
540: (229., 32., 114.),
562: (158., 119., 28.),
570: (60., 205., 27.),
572: (18., 215., 201.),
581: (79., 76., 153.),
609: (134., 13., 116.),
748: (192., 97., 63.),
776: (108., 163., 18.),
1156: (95., 220., 156.),
1163: (98., 141., 208.),
1164: (144., 19., 193.),
1165: (166., 36., 57.),
1166: (212., 202., 34.),
1167: (23., 206., 34.),
1168: (91., 211., 236.),
1169: (79., 55., 137.),
1170: (182., 19., 117.),
1171: (134., 76., 14.),
1172: (87., 185., 28.),
1173: (82., 224., 187.),
1174: (92., 110., 214.),
1175: (168., 80., 171.),
1176: (197., 63., 51.),
1178: (175., 199., 77.),
1179: (62., 180., 98.),
1180: (8., 91., 150.),
1181: (77., 15., 130.),
1182: (154., 65., 96.),
1183: (197., 152., 11.),
1184: (59., 155., 45.),
1185: (12., 147., 145.),
1186: (54., 35., 219.),
1187: (210., 73., 181.),
1188: (221., 124., 77.),
1189: (149., 214., 66.),
1190: (72., 185., 134.),
1191: (42., 94., 198.),
}


GENERAL_COLOR_MAP_200 = {i: k for i, (_, k) in enumerate(SCANNET_COLOR_MAP_200.items())}

# scannet dataset
LEARNING_MAP = {0: 0, 1: 0, 2: 0, 3: 1, 4: 2, 5: 3, 6: 4, 7: 5, 8: 6,  9: 7,
                10: 8, 11: 9, 12: 10, 13: 0, 14: 11, 15: 0, 16: 12, 17: 0,
                18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 13, 25: 0, 26: 0,
                27: 0, 28: 14, 29: 0, 30: 0, 31: 0, 32: 0, 33: 15, 34: 16, 
                35: 0, 36: 17, 37: 0, 38: 0, 39: 18, 40: 0, 50: 0, 65: 0}

LEARNING_MAP20 = {0: 0, 1: 19, 2: 20, 3: 1, 4: 2, 5: 3, 6: 4, 7: 5, 8: 6,  9: 7,
                10: 8, 11: 9, 12: 10, 13: 0, 14: 11, 15: 0, 16: 12, 17: 0,
                18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 13, 25: 0, 26: 0,
                27: 0, 28: 14, 29: 0, 30: 0, 31: 0, 32: 0, 33: 15, 34: 16, 
                35: 0, 36: 17, 37: 0, 38: 0, 39: 18, 40: 0, 50: 0, 65: 0}

NAME_MAP = { 1: 'cabinet', 2: 'bed', 3: 'chair', 4: 'sofa', 5: 'table', 6: 'door', 7: 'window',
             8: 'bookshelf', 9: 'picture', 10: 'counter', 11: 'desk', 12: 'curtain', 13: 'refridgerator',
             14: 'shower curtain', 15: 'toilet', 16: 'sink', 17:' bathtub',  18: 'otherfurniture'}

NAME_MAP20 = { 1: 'cabinet', 2: 'bed', 3: 'chair', 4: 'sofa', 5: 'table', 6: 'door', 7: 'window',
             8: 'bookshelf', 9: 'picture', 10: 'counter', 11: 'desk', 12: 'curtain', 13: 'refridgerator',
             14: 'shower curtain', 15: 'toilet', 16: 'sink', 17:' bathtub',  18: 'otherfurniture',
            19: 'wall', 20: 'floor'}

LEARNING_MAP_INV = {v:k for k,v in LEARNING_MAP20.items()}
LEARNING_MAP_INV[0] = 0

SCANNET_CLASS_ID_MULTIPLIER = 1000

SCANNET_INSTANCE_CLASS_NAMES = ['cabinet', 'bed', 'chair', 'couch', 'table', 'door', 'window', 'bookshelf', 'picture', 'counter', 'desk', 'curtain', 'refrigerator', 'shower curtain', 'toilet', 'sink', 'bathtub', 'otherfurniture']


SCANNET_VALID_CLASS_IDS_200 = [
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 23, 24, 26, 27, 28, 29, 31, 32, 33, 34, 35, 36, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 51, 52, 54, 55, 56, 57, 58, 59, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
72, 73, 74, 75, 76, 77, 78, 79, 80, 82, 84, 86, 87, 88, 89, 90, 93, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 110, 112, 115, 116, 118, 120, 121, 122, 125, 128, 130, 131, 132, 134, 136, 138, 139, 140, 141, 145, 148, 154,
155, 156, 157, 159, 161, 163, 165, 166, 168, 169, 170, 177, 180, 185, 188, 191, 193, 195, 202, 208, 213, 214, 221, 229, 230, 232, 233, 242, 250, 261, 264, 276, 283, 286, 300, 304, 312, 323, 325, 331, 342, 356, 370, 392, 395, 399, 408, 417,
488, 540, 562, 570, 572, 581, 609, 748, 776, 1156, 1163, 1164, 1165, 1166, 1167, 1168, 1169, 1170, 1171, 1172, 1173, 1174, 1175, 1176, 1178, 1179, 1180, 1181, 1182, 1183, 1184, 1185, 1186, 1187, 1188, 1189, 1190, 1191]

# SCANNET_200
SCANNET_CLASS_LABELS_200 = [
    # "wall",
    "chair",
    # "floor",
    "table",
    "door",
    "couch",
    "cabinet",
    "shelf",
    "desk",
    "office chair",
    "bed",
    "pillow",
    "sink",
    "picture",
    "window",
    "toilet",
    "bookshelf",
    "monitor",
    "curtain",
    "book",
    "armchair",
    "coffee table",
    "box",
    "refrigerator",
    "lamp",
    "kitchen cabinet",
    "towel",
    "clothes",
    "tv",
    "nightstand",
    "counter",
    "dresser",
    "stool",
    "cushion",
    "plant",
    "ceiling",
    "bathtub",
    "end table",
    "dining table",
    "keyboard",
    "bag",
    "backpack",
    "toilet paper",
    "printer",
    "tv stand",
    "whiteboard",
    "blanket",
    "shower curtain",
    "trash can",
    "closet",
    "stairs",
    "microwave",
    "stove",
    "shoe",
    "computer tower",
    "bottle",
    "bin",
    "ottoman",
    "bench",
    "board",
    "washing machine",
    "mirror",
    "copier",
    "basket",
    "sofa chair",
    "file cabinet",
    "fan",
    "laptop",
    "shower",
    "paper",
    "person",
    "paper towel dispenser",
    "oven",
    "blinds",
    "rack",
    "plate",
    "blackboard",
    "piano",
    "suitcase",
    "rail",
    "radiator",
    "recycling bin",
    "container",
    "wardrobe",
    "soap dispenser",
    "telephone",
    "bucket",
    "clock",
    "stand",
    "light",
    "laundry basket",
    "pipe",
    "clothes dryer",
    "guitar",
    "toilet paper holder",
    "seat",
    "speaker",
    "column",
    "bicycle",
    "ladder",
    "bathroom stall",
    "shower wall",
    "cup",
    "jacket",
    "storage bin",
    "coffee maker",
    "dishwasher",
    "paper towel roll",
    "machine",
    "mat",
    "windowsill",
    "bar",
    "toaster",
    "bulletin board",
    "ironing board",
    "fireplace",
    "soap dish",
    "kitchen counter",
    "doorframe",
    "toilet paper dispenser",
    "mini fridge",
    "fire extinguisher",
    "ball",
    "hat",
    "shower curtain rod",
    "water cooler",
    "paper cutter",
    "tray",
    "shower door",
    "pillar",
    "ledge",
    "toaster oven",
    "mouse",
    "toilet seat cover dispenser",
    "furniture",
    "cart",
    "storage container",
    "scale",
    "tissue box",
    "light switch",
    "crate",
    "power outlet",
    "decoration",
    "sign",
    "projector",
    "closet door",
    "vacuum cleaner",
    "candle",
    "plunger",
    "stuffed animal",
    "headphones",
    "dish rack",
    "broom",
    "guitar case",
    "range hood",
    "dustpan",
    "hair dryer",
    "water bottle",
    "handicap bar",
    "purse",
    "vent",
    "shower floor",
    "water pitcher",
    "mailbox",
    "bowl",
    "paper bag",
    "alarm clock",
    "music stand",
    "projector screen",
    "divider",
    "laundry detergent",
    "bathroom counter",
    "object",
    "bathroom vanity",
    "closet wall",
    "laundry hamper",
    "bathroom stall door",
    "ceiling light",
    "trash bin",
    "dumbbell",
    "stair rail",
    "tube",
    "bathroom cabinet",
    "cd case",
    "closet rod",
    "coffee kettle",
    "structure",
    "shower head",
    "keyboard piano",
    "case of water bottles",
    "coat rack",
    "storage organizer",
    "folded chair",
    "fire alarm",
    "power strip",
    "calendar",
    "poster",
    "potted plant",
    "luggage",
    "mattress",
    "wall",
    "floor"
]

SCANNET_INSTANCE_CLASS_NAMES_200 = SCANNET_CLASS_LABELS_200[:-2]
SCANNET200_NAME_MAP  = {i+1: name for i, name in enumerate(SCANNET_CLASS_LABELS_200)}
SCANNET200_LEARNING_MAP = {class_id: (i + 1) - 2 for i, class_id in enumerate(SCANNET_VALID_CLASS_IDS_200)}
SCANNET200_NAME_TO_ID = {v:k for k,v in SCANNET200_NAME_MAP.items()}
# SCANNET200_LEARNING_MAP = {k:k-2  for k,v in SCANNET200_NAME_MAP.items()}

SCANNET200_LEARNING_MAP[1] = 199
SCANNET200_LEARNING_MAP[2] = 1
SCANNET200_LEARNING_MAP[3] = 200
SCANNET200_LEARNING_MAP[4] = 2
SCANNET200_CLASS_ID_MULTIPLIER = 1000
SCANNET200_NUM_CLASSES = len(SCANNET_CLASS_LABELS_200)

### This file contains the HEAD - COMMON - TAIL split category ids for ScanNet 200

HEAD_CATS_SCANNET_200 = [
    "tv stand",
    "curtain",
    "blinds",
    "shower curtain",
    "bookshelf",
    "tv",
    "kitchen cabinet",
    "pillow",
    "lamp",
    "dresser",
    "monitor",
    "object",
    "ceiling",
    "board",
    "stove",
    "closet wall",
    "couch",
    "office chair",
    "kitchen counter",
    "shower",
    "closet",
    "doorframe",
    "sofa chair",
    "mailbox",
    "nightstand",
    "washing machine",
    "picture",
    "book",
    "sink",
    "recycling bin",
    "table",
    "backpack",
    "shower wall",
    "toilet",
    "copier",
    "counter",
    "stool",
    "refrigerator",
    "window",
    "file cabinet",
    "chair",
    "wall",
    "plant",
    "coffee table",
    "stairs",
    "armchair",
    "cabinet",
    "bathroom vanity",
    "bathroom stall",
    "mirror",
    "blackboard",
    "trash can",
    "stair rail",
    "box",
    "towel",
    "door",
    "clothes",
    "whiteboard",
    "bed",
    "floor",
    "bathtub",
    "desk",
    "wardrobe",
    "clothes dryer",
    "radiator",
    "shelf",
]
COMMON_CATS_SCANNET_200 = [
    "cushion",
    "end table",
    "dining table",
    "keyboard",
    "bag",
    "toilet paper",
    "printer",
    "blanket",
    "microwave",
    "shoe",
    "computer tower",
    "bottle",
    "bin",
    "ottoman",
    "bench",
    "basket",
    "fan",
    "laptop",
    "person",
    "paper towel dispenser",
    "oven",
    "rack",
    "piano",
    "suitcase",
    "rail",
    "container",
    "telephone",
    "stand",
    "light",
    "laundry basket",
    "pipe",
    "seat",
    "column",
    "bicycle",
    "ladder",
    "jacket",
    "storage bin",
    "coffee maker",
    "dishwasher",
    "machine",
    "mat",
    "windowsill",
    "bulletin board",
    "fireplace",
    "mini fridge",
    "water cooler",
    "shower door",
    "pillar",
    "ledge",
    "furniture",
    "cart",
    "decoration",
    "closet door",
    "vacuum cleaner",
    "dish rack",
    "range hood",
    "projector screen",
    "divider",
    "bathroom counter",
    "laundry hamper",
    "bathroom stall door",
    "ceiling light",
    "trash bin",
    "bathroom cabinet",
    "structure",
    "storage organizer",
    "potted plant",
    "mattress",
]
TAIL_CATS_SCANNET_200 = [
    "paper",
    "plate",
    "soap dispenser",
    "bucket",
    "clock",
    "guitar",
    "toilet paper holder",
    "speaker",
    "cup",
    "paper towel roll",
    "bar",
    "toaster",
    "ironing board",
    "soap dish",
    "toilet paper dispenser",
    "fire extinguisher",
    "ball",
    "hat",
    "shower curtain rod",
    "paper cutter",
    "tray",
    "toaster oven",
    "mouse",
    "toilet seat cover dispenser",
    "storage container",
    "scale",
    "tissue box",
    "light switch",
    "crate",
    "power outlet",
    "sign",
    "projector",
    "candle",
    "plunger",
    "stuffed animal",
    "headphones",
    "broom",
    "guitar case",
    "dustpan",
    "hair dryer",
    "water bottle",
    "handicap bar",
    "purse",
    "vent",
    "shower floor",
    "water pitcher",
    "bowl",
    "paper bag",
    "alarm clock",
    "music stand",
    "laundry detergent",
    "dumbbell",
    "tube",
    "cd case",
    "closet rod",
    "coffee kettle",
    "shower head",
    "keyboard piano",
    "case of water bottles",
    "coat rack",
    "folded chair",
    "fire alarm",
    "power strip",
    "calendar",
    "poster",
    "luggage",
]

SCANNET200_HEAD_CATEGORY_IDS = [SCANNET200_NAME_TO_ID[cat] for cat in HEAD_CATS_SCANNET_200]
SCANNET200_COMMON_CATEGORY_IDS = [SCANNET200_NAME_TO_ID[cat] for cat in COMMON_CATS_SCANNET_200]
SCANNET200_TAIL_CATEGORY_IDS = [SCANNET200_NAME_TO_ID[cat] for cat in TAIL_CATS_SCANNET_200]

SCANNET200_MISSING_IDS_FROM_VAL_TEST = [
    197, 182, 165, 158, 152
]
SCANNET200_LEARNING_MAP_INV = {v:k for k,v in SCANNET200_LEARNING_MAP.items()}

# we are not training on some classes which do not belong in val and test
# this is to fit in 512 sequence dimension for training open vocab model
# you can remove the below if you don't care about open vocab and really
# want to train on all classes
for id in SCANNET200_MISSING_IDS_FROM_VAL_TEST:
    SCANNET200_LEARNING_MAP[SCANNET200_LEARNING_MAP_INV[id]] = 0

VALID_CLASS_IDS_200_VALIDATION = (
    "wall",
    "chair",
    "floor",
    "table",
    "door",
    "couch",
    "cabinet",
    "shelf",
    "desk",
    "office chair",
    "bed",
    "pillow",
    "sink",
    "picture",
    "window",
    "toilet",
    "bookshelf",
    "monitor",
    "curtain",
    "book",
    "armchair",
    "coffee table",
    "box",
    "refrigerator",
    "lamp",
    "kitchen cabinet",
    "towel",
    "clothes",
    "tv",
    "nightstand",
    "counter",
    "dresser",
    "stool",
    "cushion",
    "plant",
    "ceiling",
    "bathtub",
    "end table",
    "dining table",
    "keyboard",
    "bag",
    "backpack",
    "toilet paper",
    "printer",
    "tv stand",
    "whiteboard",
    "blanket",
    "shower curtain",
    "trash can",
    "closet",
    "stairs",
    "microwave",
    "stove",
    "shoe",
    "computer tower",
    "bottle",
    "bin",
    "ottoman",
    "bench",
    "board",
    "washing machine",
    "mirror",
    "copier",
    "basket",
    "sofa chair",
    "file cabinet",
    "fan",
    "laptop",
    "shower",
    "paper",
    "person",
    "paper towel dispenser",
    "oven",
    "blinds",
    "rack",
    "plate",
    "blackboard",
    "piano",
    "suitcase",
    "rail",
    "radiator",
    "recycling bin",
    "container",
    "wardrobe",
    "soap dispenser",
    "telephone",
    "bucket",
    "clock",
    "stand",
    "light",
    "laundry basket",
    "pipe",
    "clothes dryer",
    "guitar",
    "toilet paper holder",
    "seat",
    "speaker",
    "column",
    "ladder",
    "bathroom stall",
    "shower wall",
    "cup",
    "jacket",
    "storage bin",
    "coffee maker",
    "dishwasher",
    "paper towel roll",
    "machine",
    "mat",
    "windowsill",
    "bar",
    "toaster",
    "bulletin board",
    "ironing board",
    "fireplace",
    "soap dish",
    "kitchen counter",
    "doorframe",
    "toilet paper dispenser",
    "mini fridge",
    "fire extinguisher",
    "ball",
    "hat",
    "shower curtain rod",
    "water cooler",
    "paper cutter",
    "tray",
    "shower door",
    "pillar",
    "ledge",
    "toaster oven",
    "mouse",
    "toilet seat cover dispenser",
    "furniture",
    "cart",
    "scale",
    "tissue box",
    "light switch",
    "crate",
    "power outlet",
    "decoration",
    "sign",
    "projector",
    "closet door",
    "vacuum cleaner",
    "plunger",
    "stuffed animal",
    "headphones",
    "dish rack",
    "broom",
    "range hood",
    "dustpan",
    "hair dryer",
    "water bottle",
    "handicap bar",
    "vent",
    "shower floor",
    "water pitcher",
    "mailbox",
    "bowl",
    "paper bag",
    "projector screen",
    "divider",
    "laundry detergent",
    "bathroom counter",
    "object",
    "bathroom vanity",
    "closet wall",
    "laundry hamper",
    "bathroom stall door",
    "ceiling light",
    "trash bin",
    "dumbbell",
    "stair rail",
    "tube",
    "bathroom cabinet",
    "closet rod",
    "coffee kettle",
    "shower head",
    "keyboard piano",
    "case of water bottles",
    "coat rack",
    "folded chair",
    "fire alarm",
    "power strip",
    "calendar",
    "poster",
    "potted plant",
    "mattress",
)

VALID_CLASS_IDS_200_TRAIN_ONLY = (
    "bicycle",
    "storage container",
    "candle",
    "guitar case",
    "purse",
    "alarm clock",
    "music stand",
    "cd case",
    "structure",
    "storage organizer",
    "luggage",
)


# AI2Thor dataset
AI2THOR_CLASS_NAMES =  [
            'ShowerDoor', 'Cabinet', 'CounterTop', 'Sink', 'Towel', 'HandTowel', 'TowelHolder', 'SoapBar', 
            'ToiletPaper', 'ToiletPaperHanger', 'HandTowelHolder', 'SoapBottle', 'GarbageCan', 'Candle', 'ScrubBrush', 
            'Plunger', 'SinkBasin', 'Cloth', 'SprayBottle', 'Toilet', 'Faucet', 'ShowerHead', 'Box', 'Bed', 'Book', 
            'DeskLamp', 'BasketBall', 'Pen', 'Pillow', 'Pencil', 'CellPhone', 'KeyChain', 'Painting', 'CreditCard', 
            'AlarmClock', 'CD', 'Laptop', 'Drawer', 'SideTable', 'Chair', 'Blinds', 'Desk', 'Curtains', 'Dresser', 
            'Watch', 'Television', 'WateringCan', 'Newspaper', 'FloorLamp', 'RemoteControl', 'HousePlant', 'Statue', 
            'Ottoman', 'ArmChair', 'Sofa', 'DogBed', 'BaseballBat', 'TennisRacket', 'VacuumCleaner', 'Mug', 'ShelvingUnit', 
            'Shelf', 'StoveBurner', 'Apple', 'Lettuce', 'Bottle', 'Egg', 'Microwave', 'CoffeeMachine', 'Fork', 'Fridge', 
            'WineBottle', 'Spatula', 'Bread', 'Tomato', 'Pan', 'Cup', 'Pot', 'SaltShaker', 'Potato', 'PepperShaker', 
            'ButterKnife', 'StoveKnob', 'Toaster', 'DishSponge', 'Spoon', 'Plate', 'Knife', 'DiningTable', 'Bowl', 
            'LaundryHamper', 'Vase', 'Stool', 'CoffeeTable', 'Poster', 'Bathtub', 'TissueBox', 'Footstool', 'BathtubBasin', 
            'ShowerCurtain', 'TVStand', 'Boots', 'RoomDecor', 'PaperTowelRoll', 'Ladle', 'Kettle', 'Safe', 'GarbageBag', 'TeddyBear', 
            'TableTopDecor', 'Dumbbell', 'Desktop', 'AluminumFoil', 'Window', 'LightSwitch', 'Wall', 'Floor']

AI2THOR_NAME_MAP  = {i+1: name for i, name in enumerate(AI2THOR_CLASS_NAMES)}
AI2THOR_NAME_TO_ID = {v:k for k,v in AI2THOR_NAME_MAP.items()}
AI2THOR_CLASS_ID_MULTIPLIER = 200
AI2THOR_NUM_CLASSES = len(AI2THOR_CLASS_NAMES)

AI2THOR_MISSING_CLASS_IDS = [1, 2, 5, 6, 7, 10, 11, 15, 22, 36, 41, 43, 47, 63, 83, 95, 96, 98, 99, 100, 112, 113, 115]

AI2THOR_INSTANCE_CLASS_NAMES = AI2THOR_CLASS_NAMES[:-2]

DATASETS_2D = ['coco']
DATASETS_3D = ['scannet', 'ai2thor']


S3DIS_NAME_MAP = {
            1: "ceiling", #
            2: "floor", #
            3: "wall",
            4: "beam", #
            5: "column", #
            6: "window", #
            7: "door", #
            8: "table", #
            9: "chair",
            10: "sofa",
            11: "bookcase", #
            12: "board", #
            13: "clutter",
}


SCANNET_LIKE_DATASET = ['scannet', 'ai2thor', 'replica', 's3dis', 'alfred', 'matterport']

AI2THOR_NON_MISSING_CLASS_IDS = [i+1 for i in range(AI2THOR_NUM_CLASSES) if i+1 not in AI2THOR_MISSING_CLASS_IDS]
AI2THOR_NON_MISSING_CLASS_NAMES = [name for i, name in enumerate(AI2THOR_CLASS_NAMES) if i+1 not in AI2THOR_MISSING_CLASS_IDS]


CLASS_NAME_DICT = {
    'ai2thor_valid': AI2THOR_NON_MISSING_CLASS_IDS,
    'scannet200_head': SCANNET200_HEAD_CATEGORY_IDS,
    'scannet200_common': SCANNET200_COMMON_CATEGORY_IDS,
    'scannet200_tail': SCANNET200_TAIL_CATEGORY_IDS,
}


# ALFRED 
ALFRED_CLASS_NAMES = copy(AI2THOR_CLASS_NAMES)
ALFRED_CLASS_NAMES.extend(['AppleSliced', 'BreadSliced', 'EggCracked', 'LettuceSliced', 'PotatoSliced', 'TomatoSliced'])
ALFRED_NAME_MAP = {i+1: name for i, name in enumerate(ALFRED_CLASS_NAMES)}
ALFRED_NAME_TO_ID = {v:k for k,v in ALFRED_NAME_MAP.items()}
ALFRED_CLASS_ID_MULTIPLIER = 200
ALFRED_NUM_CLASSES = len(ALFRED_CLASS_NAMES)



# MATTERPORT 3D
MATTERPORT_CLASS_LABELS = ['wall', 'door', 'ceiling', 'floor', 'picture', 'window', 'chair', 'pillow', 'lamp', 'cabinet', 'curtain', 'table', 'plant', 'mirror', 'towel', 'sink', 'shelves', 'sofa', 'bed', 'night stand', 'toilet', 'column', 'banister', 'stairs', 'stool', 'vase', 'television', 'pot', 'desk', 'box', 'coffee table', 'counter', 'bench', 'garbage bin', 'fireplace', 'clothes', 'bathtub', 'book', 'air vent', 'faucet', 'photo', 'toilet paper', 'fan', 'railing', 'sculpture', 'dresser', 'rug', 'ottoman', 'bottle', 'refridgerator', 'bookshelf', 'wardrobe', 'pipe', 'monitor', 'stand', 'drawer', 'container', 'light switch', 'purse', 'door way', 'basket', 'chandelier', 'oven', 'clock', 'stove', 'washing machine', 'shower curtain', 'fire alarm', 'bin', 'chest', 'microwave', 'blinds', 'bowl', 'tissue box', 'plate', 'tv stand', 'shoe', 'heater', 'headboard', 'bucket', 'candle', 'flower pot', 'speaker', 'furniture', 'sign', 'air conditioner', 'fire extinguisher', 'curtain rod', 'floor mat', 'printer', 'telephone', 'blanket', 'handle', 'shower head', 'soap', 'keyboard', 'thermostat', 'radiator', 'kitchen island', 'paper towel', 'sheet', 'glass', 'dishwasher', 'cup', 'ladder', 'garage door', 'hat', 'exit sign', 'piano', 'board', 'rope', 'ball', 'excercise equipment', 'hanger', 'candlestick', 'light', 'scale', 'bag', 'laptop', 'treadmill', 'guitar', 'display case', 'toilet paper holder', 'bar', 'tray', 'urn', 'decorative plate', 'pool table', 'jacket', 'bottle of soap', 'water cooler', 'utensil', 'tea pot', 'stuffed animal', 'paper towel dispenser', 'lamp shade', 'car', 'toilet brush', 'doll', 'drum', 'whiteboard', 'range hood', 'candelabra', 'toy', 'foot rest', 'soap dish', 'placemat', 'cleaner', 'computer', 'knob', 'paper', 'projector', 'coat hanger', 'case', 'pan', 'luggage', 'trinket', 'chimney', 'person', 'alarm']
MATTERPORT_NAME_MAP = {i+1: name for i, name in enumerate(MATTERPORT_CLASS_LABELS)}
MATTERPORT_NAME_TO_ID = {v:k for k,v in MATTERPORT_NAME_MAP.items()}
MATTERPORT_LEARNING_MAP = {i + 1: i + 1 for i in range(len(MATTERPORT_CLASS_LABELS))}
MATTERPORT_LEARNING_MAP[255] = 0
MATTERPORT_LEARNING_MAP[0] = 0
MATTERPORT_CLASS_ID_MULTIPLIER = 1000


MATTERPORT_ALL_CLASSES_TO_21 = {1: 1, 2: 8, 3: 22, 4: 2, 5: 11, 6: 9, 7: 5, 8: 0, 9: 0, 10: 3, 11: 16, 12: 7, 13: 0, 14: 0, 15: 0, 16: 34, 17: 0, 18: 6, 19: 4, 20: 0, 21: 33, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 14, 30: 0, 31: 39, 32: 12, 33: 39, 34: 39, 35: 0, 36: 0, 37: 36, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0, 43: 0, 44: 0, 45: 0, 46: 0, 47: 0, 48: 39, 49: 0, 50: 24, 51: 10, 52: 39, 53: 0, 54: 0, 55: 39, 56: 39, 57: 0, 58: 0, 59: 0, 60: 0, 61: 0, 62: 0, 63: 0, 64: 0, 65: 0, 66: 39, 67: 28, 68: 0, 69: 0, 70: 39, 71: 0, 72: 0, 73: 0, 74: 0, 75: 0, 76: 39, 77: 0, 78: 39, 79: 39, 80: 0, 81: 0, 82: 0, 83: 0, 84: 39, 85: 0, 86: 0, 87: 0, 88: 0, 89: 0, 90: 0, 91: 0, 92: 0, 93: 0, 94: 0, 95: 0, 96: 0, 97: 0, 98: 39, 99: 0, 100: 0, 101: 0, 102: 0, 103: 0, 104: 0, 105: 39, 106: 0, 107: 0, 108: 0, 109: 39, 110: 0, 111: 0, 112: 0, 113: 39, 114: 0, 115: 0, 116: 0, 117: 0, 118: 0, 119: 0, 120: 39, 121: 0, 122: 39, 123: 0, 124: 0, 125: 0, 126: 0, 127: 0, 128: 39, 129: 0, 130: 0, 131: 39, 132: 0, 133: 0, 134: 0, 135: 0, 136: 0, 137: 0, 138: 0, 139: 0, 140: 0, 141: 0, 142: 0, 143: 0, 144: 0, 145: 39, 146: 0, 147: 0, 148: 0, 149: 0, 150: 0, 151: 0, 152: 0, 153: 0, 154: 0, 155: 0, 156: 0, 157: 0, 158: 0, 159: 0, 160: 0}
